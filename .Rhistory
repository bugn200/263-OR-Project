reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hover Board","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
tm_shape(range)+tm_raster()+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots()
reclass_df <- c(0, 32e3, 1,
32e3, 100e3, 2,
100e3, 210e3, 3,
210e3, Inf, 4)
reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hover Board","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
tm_shape(range)+tm_raster()+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots(labels=("70 Symonds Street"))
reclass_df <- c(0, 32e3, 1,
32e3, 100e3, 2,
100e3, 210e3, 3,
210e3, Inf, 4)
reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hover Board","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
name(range)="Range"
reclass_df <- c(0, 32e3, 1,
32e3, 100e3, 2,
100e3, 210e3, 3,
210e3, Inf, 4)
reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hover Board","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
names(range)="Range"
tm_shape(range)+tm_raster()+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots(labels=("70 Symonds Street"))
reclass_df <- c(0, 32e3, 1,
32e3, 100e3, 2,
100e3, 210e3, 3,
210e3, Inf, 4)
reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hover Board","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
names(range)="Range"
tm_shape(range)+tm_raster()+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots()
reclass_df <- c(0, 32e3, 1,
32e3, 100e3, 2,
100e3, 210e3, 3,
210e3, Inf, 4)
reclass_m <- matrix(reclass_df,
ncol = 3,
byrow = TRUE)
range=reclassify(dist_prediction,reclass_m)
k=ratify(range)
rat=levels(k)[[1]]|>mutate(legends=c("Hoverboard","Lime Scooter","Electric car","Out of range"))
rat$Pixel_Values=1:4
levels(range)=rat
names(range)="Range"
tm_shape(range)+tm_raster()+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots()
distmodel=gstat(formula=dist~1,locations=distances,nmax=15,set=list(idp=7))
ext1=extent(xmin,xmax,ymin,ymax)
r2=raster(ext1,res=150,crs=2193)
r2 = rasterize(nzpolygon, r2)
grid2=as(r2,"SpatialGrid")
distpred=predict(distmodel,grid2)
dist_brick = brick(distpred)
dist_prediction=dist_brick[[1]] %>% mask(r2)
names(dist_prediction) = "Distance"
tm_shape(dist_prediction)+tm_raster(palette = "Spectral")+tm_layout(legend.outside = TRUE)+tm_shape(uoa439)+tm_dots()
source("Task8.R")
distances=OSRMdistances(uoa439,st_as_sf(r1))
tm_shape(distances)+tm_dots(col="dist",palette="Spectral")+tm_layout(legend.outside = TRUE)
shortest=osrmRoute(home,uoa402)
shortest=st_as_sf(shortest, coords=c("lon","lat"),crs=4326)
shortest=st_transform(shortest, 2193)
shortest_line=shortest|>summarise(do_union=F)|>st_cast("LINESTRING")
tm_shape(uniroute)+tm_dots()+tm_shape(shortest_line)+tm_lines(col="red")
library(osrm)
string1="Hello world"
split1=strsplit(string1,split=" ")
View(split1)
View(split1)
split1[[1]]
split1[1][2]
split1[[1]
split1[[2]]
split1[[1]][1]
split1[[1]][2]
library(tmap)
?par
setwd("C:/Users/minhn/263-OR-Project")
library(sf)
library(spData)
library (tidyverse)
library(tmap)
library(mapedit)
#Read Supermarket location data from the csv
supermarket_raw=read.csv('data/WoolworthsRegion.csv')
#Convert Longitude and Latitude to be a geometry, using EPSG 4326 system
supermarket=st_as_sf(supermarket_raw,coords=c("Long","Lat"),crs=4326)
#Transform coordinate into NZGD2000 coordinate system
supermarket=st_transform(supermarket,2193)
#Set tmap mode to plot
tmap_mode("plot")
#Read the shape file for New Zealand for territorial authorities
nz_shape=st_read("Shape_files/TA_2018_clipped")
#Get the shape of Auckland
akl_shape=nz_shape%>%filter(TA2018_V_1=="Auckland")
#Crop the map for the area of interest
akl_shape=st_crop(akl_shape,xmin=1740000,xmax=1781000,ymin=5890000,ymax=5940000)
#Initially visualise data for weekdays
data_vis=tm_shape(akl_shape)+tm_polygons()+tm_shape(supermarket)+tm_dots(col='Type',palette='Dark2',size=0.3)+ tm_layout(legend.position = c("right", "top"),
title= 'Woolworth supermarkets location',
title.position = c('right', 'top'),legend.frame = TRUE)
#Save the plot above as png
tmap_save(data_vis,'Plot/locations.png')
#Create supermarket data for Saturday(Only Countdowns and the Distribution center included)
saturday=filter(supermarket,Type%in%c('Countdown','Distribution Centre'))
#Initially visualise data for weekdays
data_vis_sat=tm_shape(akl_shape)+tm_polygons()+tm_shape(saturday)+tm_dots(col='Type',palette='Dark2',size=0.3)+tm_layout(legend.position = c("right", "top"),
title= 'Woolworth supermarkets locations (Saturday demands)',
title.position = c('right', 'top'),legend.frame = TRUE)
#Save the plot as png
tmap_save(data_vis_sat,'Plot/Saturday.png')
#Get the coordinate of supermarket in each region and the extent coordinates
South=filter(supermarket,Region%in%c('South','Distribution Centre Auckland'))
South_shape=st_crop(akl_shape,xmin=1758000,xmax=1777000,ymin=5895000,ymax=5913000)
North=filter(supermarket,Region%in%c('North','Distribution Centre Auckland'))
North_shape=st_crop(akl_shape,xmin=1751000,xmax=1764000,ymin=5908000,ymax=5936000)
Central=filter(supermarket,Region%in%c('Central','Distribution Centre Auckland'))
Central_shape=st_crop(akl_shape,xmin=1750000,xmax=1762500,ymin=5907800,ymax=5922000)
East=filter(supermarket,Region%in%c('East','Distribution Centre Auckland'))
East_shape=st_crop(akl_shape,xmin=1759000,xmax=1773000,ymin=5908000,ymax=5918500)
West=filter(supermarket,Region%in%c('West','Distribution Centre Auckland'))
West_shape=st_crop(akl_shape,xmin=1741100,xmax=1762000,ymin=5908000,ymax=5928000)
ggplot(akl_shape)
ggplot(akl_shape)+geom_sf(fill='white')
ggplot(akl_shape)+geom_sf(fill='white')+geom_point(supermarket)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry,color='StoreType')
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry,color=StoreType)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry,aes(fill=StoreType,palette=Dark2))
View(supermarket)
View(supermarket)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry,aes(fill=Type,palette=Dark2))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket$geometry,aes(fill=supermarket$Type))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(fill=supermarket$Type))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(fill=Type))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(fill=Type))+scale_fill_viridis_b()
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(fill=Type))+scale_fill_viridis_d()
ggplot(akl_shape)+geom_sf(fill='white')+ggplot(data=supermarket)+geom_sf(aes(fill=Type))+scale_fill_viridis_d()
ggplot()+geom_sf(akl_shape,fill=white)+geom_sf(supermarket,fill=Type)+scale_fill_viridis_d()
ggplot()+geom_sf(akl_shape,fill='white')+geom_sf(supermarket,fill=Type)+scale_fill_viridis_d()
ggplot()+geom_sf(akl_shape,aes(fill='white'))+geom_sf(supermarket,fill=Type)+scale_fill_viridis_d()
ggplot()+geom_sf(akl_shape,aes(fill='white'))+geom_sf(supermarket,aes(fill=Type))+scale_fill_viridis_d()
ggplot(supermarket)+geom_sf(fill=Type)+scale_fill_viridis_d()
ggplot(supermarket)+geom_sf(supermarket,fill=Type)+scale_fill_viridis_d()
ggplot(supermarket)+geom_sf(supermarket,aes(fill=Type))+scale_fill_viridis_d()
ggplot(supermarket)+geom_sf()
ggplot(supermarket)+geom_sf(aes(color=Type))+scale_color_viridis_d()
ggplot(supermarket)+geom_sf(aes(color=Type))+scale_color_viridis_d(direction=-1)
ggplot(supermarket)+geom_sf(aes(color=Type))+scale_color_viridis_d(direction=-1)+geom_sf(akl_shape)
ggplot(supermarket)+geom_sf(aes(color=Type))+scale_color_viridis_d(direction=-1)+geom_sf(data=akl_shape)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(fill=Type))+scale_fill_viridis_d()
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_fill_viridis_d()
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_manual(Dark2)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
ggplot(akl_shape)+geom_sf(fill='grey')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
weekdayTrips=ggplot(akl_shape)+geom_sf(fill='grey')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
#Read the route file for weekday route and save as a png
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
#Read the route file for weekday route and save as a png
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)
route1=route
}
}
weekdayTrips
weekdayTrips=ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)
route=route1
}
}
weekdayTrips
weekdayTrips=ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),
arrow=arrow(length=unit(0.2,'cm'),ends='first'),alpha=0.3)
route=route1
}
}
weekdayTrips
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(length=unit(0.2,'cm')))
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(length=unit(0.2,'cm')),alpha=0.5)
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),
arrow=arrow(length=unit(0.2,'cm')))
route=route1
}
}
weekdayTrips
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]))
route=route1
}
}
weekdayTrips=ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]))
route=route1
}
}
weekdayTrips
weekdayTrips=ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
weekdayTrips
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]))
weekdayTrips
route=route1
route2=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Auckland')$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route2[1],yend=route2[2]))
weekdayTrips
route1=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Auckland')$geometry))
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
route1=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Lincoln Road')$geometry))
weekdayTrips=weekdayTrips+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(),alpha=0.5)
weekdayTrips
ggplot(akl_shape)+geom_sf(fill='white')+geom_sf(fill='white')rket,aes(color=Type))+scale_color_brewer(palette="Dark2")
ggplot(akl_shape)+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
ggplot(akl_shape)+geom_sf(akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(),alpha=0.5)
route=route1
route1=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Airport')$geometry))
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
route1=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Lincoln Road')$geometry))
trip=ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")
trip+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(),alpha=0.5)
trip+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(unit(0.2,'cm')),alpha=0.5)
trip+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(unit(0.3,'cm')),alpha=0.5)
trip=trip+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(unit(0.3,'cm')),alpha=0.5)
route=route1
route1=as.vector(st_coordinates(filter(supermarket,Store=='Countdown Airport')$geometry))
trip=trip+geom_segment(aes(x=route[1],y=route[2],xend=route1[1],yend=route1[2]),arrow=arrow(unit(0.3,'cm')),alpha=0.5)
trip
tripMatrix=matrix(0,65,4)
View(tripMatrix)
View(tripMatrix)
trip(matrix[1])
tripMatrix[1]
tripMatrix[1][2]
tripMatrix[V1]
tripMatrix=matrix(0,65,4,dimnames=list('Long','Lat','LongEnd','LatEnd'))
colnames(tripMatrix)=c('Long','Lat','LongEnd','LatEnd')
tripMatrix('Long')
tripMatrix[,'Long']
tripMatrix[,Long][1]
tripMatrix[,'Long'][1]
weekdayRoute=readLines('data/WeekdayRouteStores.txt')
tripMatrix=matrix(0,65,4)
colnames(tripMatrix)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(weekdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
weekdayR=strsplit(weekdayRoute[i],split=',')
for(j in 1:length(weekdayR[[1]])) {
tripMatrix[,'Long'][nodeReach]=route[1]
tripMatrix[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==weekdayR[[1]][j])$geometry))
tripMatrix[,'LongEnd'][nodeReach]=route1[1]
tripMatrix[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
View(tripMatrix)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x='Long',y='Lat',xend='LongEnd',yend='LatEnd'),arrow=arrow())
tripMatrix=as.data.frame(tripMatrix)
View(tripMatrix)
View(tripMatrix)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x='Long',y='Lat',xend='LongEnd',yend='LatEnd'),arrow=arrow())
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x='Long',y='Lat',xend='LongEnd',yend='LatEnd'),arrow=arrow(unit(0.2,'cm')))
st_set_crs(tripMatrix,2193)
ggplot()++geom_segment(data=tripMatrix,aes(x='Long',y='Lat',xend='LongEnd',yend='LatEnd'),arrow=arrow(unit(0.2,'cm')))
ggplot()+geom_segment(data=tripMatrix,aes(x='Long',y='Lat',xend='LongEnd',yend='LatEnd'),arrow=arrow(unit(0.2,'cm')))
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(unit(0.2,'cm')))
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(unit(0.2,'cm')),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(unit=(1,'cm')),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(unit(1,'cm')),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(unit(0.3,'cm')),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(length=unit(0.1,'cm')),alpha=0.5)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='white')+geom_sf(data=supermarket,aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),arrow=arrow(length=unit(0.2,'cm')),alpha=0.5)
weekdayTrips=ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=supermarket,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.5)+
tmap_save(data_vis,'Plot/WeekdayRoute.png')
weekdayTrips
weekdayTrips=ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=supermarket,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.5)+labs(title='Weekday Routes')
weekdayTrips
weekdayTrips=ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=supermarket,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
weekdayTrips
ggsave(weekdayTrips,'Plot/WeekdayRoute.png')
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=supermarket,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=tripMatrix,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
ggsave('Plot/WeekdayRoute.png')
View(saturday)
View(saturday)
satTrip=matrix(0,53,4)
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
aatTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
aatTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
satTrip=as.data.frame(satTrip)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
View(satTrip)
View(satTrip)
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
satTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
satTrip=as.data.frame(satTrip)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
ggsave('Plot/SaturdayRoute')
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
satTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
satTrip=as.data.frame(satTrip)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
ggsave('Plot/SaturdayRoute')
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
satTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
satTrip=as.data.frame(satTrip)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Weekday Routes')
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Saturday Routes')
ggsave('Plot/SaturdayRoute')
saturdayRoute=readLines('data/SaturdayRouteStores.txt')
satTrip=matrix(0,53,4)
colnames(satTrip)=c('Long','Lat','LongEnd','LatEnd')
nodeReach=1
for(i in 1:length(saturdayRoute)) {
route=as.vector(st_coordinates(filter(supermarket,Store=='Distribution Centre Auckland')$geometry))
satRoute=strsplit(saturdayRoute[i],split=',')
for(j in 1:length(satRoute[[1]])) {
satTrip[,'Long'][nodeReach]=route[1]
satTrip[,'Lat'][nodeReach]=route[2]
route1=as.vector(st_coordinates(filter(supermarket,Store==satRoute[[1]][j])$geometry))
satTrip[,'LongEnd'][nodeReach]=route1[1]
satTrip[,'LatEnd'][nodeReach]=route1[2]
route=route1
nodeReach=nodeReach+1
}
}
satTrip=as.data.frame(satTrip)
ggplot(akl_shape)+geom_sf(data=akl_shape,fill='grey')+geom_sf(data=saturday,
aes(color=Type))+scale_color_brewer(palette="Dark2")+geom_segment(data=satTrip,
aes(x=Long,y=Lat,xend=LongEnd,yend=LatEnd),
arrow=arrow(length=unit(0.2,'cm')),alpha=0.3)+labs(title='Saturday Routes')
ggsave('Plot/SaturdayRoute.png')
